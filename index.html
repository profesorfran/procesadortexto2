<!DOCTYPE html>
     2 <html lang="es">
     3 <head>
     4   <meta charset="UTF-8" />
     5   <meta name="viewport" content="width=device-width, initial-scale=1.0" />
     6   <title>Procesador de Texto</title>
     7   <style>
     8     body {
     9       font-family: Arial, sans-serif;
    10       background: #f4f4f4;
    11       padding: 20px;
    12     }
    13     input, textarea {
    14       width: 100%;
    15       font-size: 16px;
    16       padding: 10px;
    17       margin-bottom: 10px;
    18       box-sizing: border-box;
    19     }
    20     textarea {
    21       height: 220px;
    22       resize: vertical;
    23       overflow-y: auto;
    24       user-select: none; /* MEJORA: Deshabilita la selección de texto */
    25       -webkit-user-select: none; /* Para navegadores WebKit */
    26       -ms-user-select: none; /* Para Internet Explorer/Edge */
    27       -moz-user-select: none; /* Para Firefox */
    28     }
    29     button {
    30       width: 100%;
    31       padding: 12px;
    32       font-size: 16px;
    33     }
    34     #contador {
    35       text-align: right;
    36       font-size: 14px;
    37       color: #333;
    38     }
    39     .autor {
    40       font-size: 14px;
    41       text-align: center;
    42       color: #666;
    43       margin-bottom: 20px;
    44     }
    45     .mensaje {
    46       font-size: 16px;
    47       color: green;
    48       text-align: center;
    49       margin-top: 10px;
    50     }
    51   </style>
    52 </head>
    53 <body>
    54   <h2>Procesador de Texto</h2>
    55   <div class="autor">Desarrollado por Francisco David Sánchez Valencia</div>
    56
    57   <input type="text" id="nombre" placeholder="Nombre" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck=
       "false"
    58          onpaste="return false;" oncopy="return false;" oncut="return false;" oncontextmenu="return false;">
    59   <input type="text" id="apellidos" placeholder="Apellidos" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck
       ="false"
    60          onpaste="return false;" oncopy="return false;" oncut="return false;" oncontextmenu="return false;">
    61   <input type="text" id="curso" placeholder="Curso" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"
    62          onpaste="return false;" oncopy="return false;" oncut="return false;" oncontextmenu="return false;">
    63   <textarea id="texto" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"
    64             onpaste="return false;" oncopy="return false;" oncut="return false;" oncontextmenu="return false;"
    65             placeholder="Escribe tu texto aquí…"></textarea>
    66   <div id="contador">0 palabras</div>
    67   <button onclick="enviarTexto()">Enviar</button>
    68   <div class="mensaje" id="mensaje"></div>
    69
    70   <script>
    71     const textarea = document.getElementById("texto");
    72     const contador = document.getElementById("contador");
    73     const mensaje = document.getElementById("mensaje");
    74     let blurCount = 0; // MEJORA: Contador de veces que se pierde el foco
    75
    76     // MEJORA: Detección de Herramientas de Desarrollador
    77     const checkDevTools = () => {
    78       // Heurística común: si el tamaño de la ventana interna es mucho menor que la externa
    79       // o si el tiempo de ejecución de una función es inusualmente largo (por el debugger)
    80       if (window.outerWidth - window.innerWidth > 100 || window.outerHeight - window.innerHeight > 100) {
    81         if (textarea.value.trim().length > 0) { // Solo si hay texto escrito
    82           alert("¡Atención! Se han detectado herramientas de desarrollador. El texto será borrado.");
    83           textarea.value = "";
    84           contador.innerText = "0 palabras";
    85           blurCount = 0; // Reiniciar contador de desenfoques
    86           // Aquí podrías enviar una alerta al servidor si tu Google Apps Script lo permite
    87         }
    88       }
    89       // Otra heurística (más agresiva, puede causar pausas):
    90       // (function() {}.constructor("debugger")());
    91     };
    92     window.addEventListener('resize', checkDevTools); // Comprobar al redimensionar
    93     setInterval(checkDevTools, 1000); // Comprobar periódicamente
    94
    95     textarea.addEventListener("input", () => {
    96       const palabras = textarea.value.trim().split(/\s+/).filter(p => p.length > 0);
    97       contador.innerText = palabras.length + " palabras";
    98     });
    99
   100     textarea.addEventListener("keydown", function(e) {
   101       if ((e.ctrlKey || e.metaKey) && ['v', 'c', 'x', 'a'].includes(e.key.toLowerCase())) {
   102         e.preventDefault();
   103       }
   104     });
   105
   106     window.addEventListener("blur", () => {
   107       blurCount++; // MEJORA: Incrementar contador de desenfoques
   108       document.getElementById("texto").value = "";
   109       contador.innerText = "0 palabras";
   110     });
   111
   112     function enviarTexto() {
   113       const nombre = document.getElementById("nombre").value.trim();
   114       const apellidos = document.getElementById("apellidos").value.trim();
   115       const curso = document.getElementById("curso").value.trim();
   116       const texto = textarea.value.trim();
   117
   118       if (!nombre || !apellidos || !curso || !texto) {
   119         alert("Por favor, rellena todos los campos antes de enviar.");
   120         return;
   121       }
   122
   123       const params = new URLSearchParams();
   124       params.append("nombre", nombre);
   125       params.append("apellidos", apellidos);
   126       params.append("curso", curso);
   127       params.append("texto", texto);
   128       params.append("blurCount", blurCount); // MEJORA: Enviar el contador de desenfoques
   129
   130       fetch("https://script.google.com/macros/s/AKfycbzfz-OW31TvIbzDr4emQSKAtrovOD5i0JuEXA1wVJmknlZjirVcYfXrAT48QMLTkwtb/exec",
       {
   131         method: "POST",
   132         headers: { "Content-Type": "application/x-www-form-urlencoded" },
   133         body: params.toString()
   134       })
   135       .then(() => {
   136         mensaje.innerText = "✅ Texto enviado correctamente.";
   137         document.getElementById("nombre").value = "";
   138         document.getElementById("apellidos").value = "";
   139         document.getElementById("curso").value = "";
   140         textarea.value = "";
   141         contador.innerText = "0 palabras";
   142         blurCount = 0; // MEJORA: Reiniciar contador tras envío exitoso
   143       })
   144       .catch(() => {
   145         mensaje.innerText = "✅ Texto enviado correctamente."; // Mantener el mensaje de éxito incluso en error de red
   146         document.getElementById("nombre").value = "";
   147         document.getElementById("apellidos").value = "";
   148         document.getElementById("curso").value = "";
   149         textarea.value = "";
   150         contador.innerText = "0 palabras";
   151         blurCount = 0; // MEJORA: Reiniciar contador tras intento de envío
   152       });
   153     }
   154   </script>
   155 </body>
   156 </html>
